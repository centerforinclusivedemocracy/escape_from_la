<!DOCTYPE html> 
<html> 
<head> 
<title>Leaflet.js</title> 
<meta charset="utf-8" /> 
<meta name="viewport" 
      content="width=device-width, initial-scale=1.0"> 
<!-- Get the leaflet CSS file -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.4.0/dist/leaflet.js"
  integrity="sha512-QVftwZFqvtRNi0ZyCtsznlKSWOStnDORoefr1enyq5mVL4tmKB3S/EnC3rRJcxCPavG10IcrVGSmPh6Qw5lwrg=="
  crossorigin=""></script>

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css" />

  <script src="leaflet.ajax.min"></script>

  <script src="la_prcs.geojson"></script>
<!-- Get our internal CSS file -->
<link rel="stylesheet" href="style.css">
</head> 

<body>
<!-- Specify the map and it's dimensions -->
<div id="map"></div> 
<script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"></script>


<script>   
    var map = L.map(
                "map",
                {
                    center: [34.0, -118.3],
                    crs: L.CRS.EPSG3857,
                    zoom: 9,
                    zoomControl: false,
                    // preferCanvas: true,
                }
            );
    L.control.scale().addTo(map);

    L.control.zoom({position: 'topright'}).addTo(map);
  
    var tile_layer = L.tileLayer(
                "https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",
                {"attribution": "Data by \u0026copy; \u003ca href=\"http://openstreetmap.org\"\u003eOpenStreetMap\u003c/a\u003e, under \u003ca href=\"http://www.openstreetmap.org/copyright\"\u003eODbL\u003c/a\u003e.", "detectRetina": false, "maxNativeZoom": 18, "maxZoom": 18, "minZoom": 7, "noWrap": false, "opacity": 1, "subdomains": "abc", "tms": false}
            ).addTo(map);


    // function getColor(d) {
    // return d   ? '#C4CACF' :
    //        d < 10  ? '#ffffd9' :
    //        d > 10 & <20  ? '#edf8b1' :
    //        d > 20 & <30  ? '#c7e9b4' :
    //        d > 30 & <40   ? '#7fcdbb' :
    //        d > 40 & <50   ? '#41b6c4' :
    //        d > 60 & <70   ? '#1d91c0' :
    //        d > 70 & <80   ? '#225ea8' :
    //        d > 80 & <90   ? '#253494' :
    //        d > 90   ? '#081d58' ;
    // }

    function getColor(d) {
    return d > 90 ? '#081d58' :
           d > 80  ? '#253494' :
           d > 70  ? '#225ea8' :
           d > 60  ? '#1d91c0' :
           d > 50  ? '#41b6c4' :
           d > 40  ? '#7fcdbb' :
           d > 30   ? '#c7e9b4' :
           d > 20   ? '#edf8b1' :
           d > 10   ? '#ffffd9' :
                      '#C4CACF';
}

    function style(feature) {
    return {
        fillColor: getColor(feature.properties.pctvote),
        weight: 1,
        opacity: 1,
        color: 'grey',
        // dashArray: '3',
        fillOpacity: 0.7
    };
}

fetch("la_prcs.geojson")
    .then(function(response) {
    return response.json();
    })
    .then(function(data) {
    L.geoJSON(data,{style: style}).addTo(map);
    });

// var geojsonLayer = new L.GeoJSON.AJAX("la_prcs.geojson");       
// geojsonLayer.addTo(map);
        
</script>

  <body>
  
  <div id='infobox' class='infobox' 
      style='position: absolute; z-index:9999; border:2px solid grey; width: 450px; background-color:rgba(255, 255, 255, 0.8);
       border-radius:6px; padding: 2px; font-size:14px; right: 20px; bottom: 20px;'>
       
  <div class='infobox-scale'>
      <p>
      <b>Data Source</b>: California Secretary of Stata VoteCal System<br><i>To learn about the USC Center for Inclusive Democracy visit its <a href="https://cid.usc.edu/" style="color:Blue;" target="_blank" rel="noopener noreferrer">website</a></i>.
      </p>
  </div>
  </div>
   
  </body>    

  <body>
   
  <div id='maplegend' class='maplegend' 
      style='position: absolute; z-index:9999; border:2px solid grey; background-color:rgba(255, 255, 255, 0.8);
       border-radius:6px; padding: 2px; font-size:14px; right: 20px; top: 150px;'>
       
  <div class='legend-title'>Percent of Registered<br>Voters Casting Ballots</div>
  <div class='legend-scale'>
    <ul class='legend-labels'>
      <li><span style='background:#C4CACF;opacity:0.7;'></span>No Data</li>
      <li><span style='background:#ffffd9;opacity:0.7;'></span><10%</li>
      <li><span style='background:#edf8b1;opacity:0.7;'></span>10-20%</li>
      <li><span style='background:#c7e9b4;opacity:0.7;'></span>20-30%</li>
      <li><span style='background:#7fcdbb;opacity:0.7;'></span>30-40%</li>
      <li><span style='background:#41b6c4;opacity:0.7;'></span>40-50%</li>
      <li><span style='background:#1d91c0;opacity:0.7;'></span>50-60%</li>
      <li><span style='background:#225ea8;opacity:0.7;'></span>60-70%</li>
      <li><span style='background:#253494;opacity:0.7;'></span>70-80%</li>
      <li><span style='background:#081d58;opacity:0.7;'></span>>90%</li>
  
    </ul>
  </div>
  </div>
   
  </body> 
  <body>
  
  <div id='maplegend' class='maplegend' 
      style='position: absolute; z-index:9999; border:2px solid grey; background-color:rgba(255, 255, 255, 0.8);
       border-radius:6px; padding-top: 0px; padding-bottom:1px; padding-right:10px; padding-left:10px; font-size:14px; 
       top: 20px; left: 20px;'>
       
  <div class='legend-title'> 
      <h3 align="center" style="font-size:20px"><b>Los Angeles County Early<br>Vote Count by Precinct</b></h3>
      <h4 align="center" style="font-size:15px"><b>2020 General Election</b></h4>
      <h5 align="center"style="font-size:12px">Last Updated: 10/20/2020</h5> 
  </div>
  </div>

  <img id="float_image" alt="float_image"
                 src="https://raw.githubusercontent.com/centerforinclusivedemocracy/la-vote/folium-map-final/CID3.png?token=AEH24OAXWBYTBNIU22O23VK7TIJYM"
                 style='position: absolute; z-index:9999; padding-top: 0px; padding-bottom:1px; padding-right:10px; padding-left:10px; font-size:14px; bottom: 30px; left: 3px;'>
</img>
   
  </body>
</script>
</body> 
</html> 